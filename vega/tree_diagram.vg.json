{
  "$schema": "https://vega.github.io/schema/vega/v5.json",
  "data": [
    {
      "name": "source",
      "url": "https://raw.githubusercontent.com/bradfordjohnson/example-data/main/data/tree_data_unstr.csv",
      "format": { "type": "csv" }
    },
    {
      "name": "id_lookup",
      "source": "source",
      "transform": [
        {
          "type": "window",
          "ops": ["row_number"],
          "as": ["id"]
        },
        {
          "type": "formula",
          "expr": "datum.parent === '' ? null : datum.parent",
          "as": "parent"
        }
      ]
    },
    {
      "name": "parent_lookup",
      "source": "id_lookup",
      "transform": [
        {
          "type": "lookup",
          "from": "id_lookup",
          "key": "name",
          "fields": ["parent"],
          "values": ["id"],
          "as": ["parent_id"]
        }
      ]
    }
  ]
}
